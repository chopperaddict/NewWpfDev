<Window x:Class="Views.Genericgrid"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:Views"
        xmlns:users="clr-namespace:UserControls"
        xmlns:user="clr-namespace:NewWpfDev.UserControls"
        xmlns:conv="clr-namespace:NewWpfDev.Converts"
        xmlns:model="clr-namespace:NewWpfDev.Models"
        xmlns:Viewmodels="clr-namespace:NewWpfDev.ViewModels"
        xmlns:att="clr-namespace:NewWpfDev.AttachedProperties"
        mc:Ignorable="d"
        WindowChrome.ResizeGripDirection="BottomRight"
	    ResizeMode="CanResizeWithGrip"        
        Title="Generic SQL Tables - Right Click for more information..."
        FontSize="20"
        TextElement.Foreground="White"
        SizeChanged="Gengrid_SizeChanged"
        Height="750" Width="900"
        MinHeight="550" MinWidth="880"
        Loaded="Grid_Loaded"
        LostFocus="FieldSelectionGrid_LostFocus"
        KeyDown="InfoGrid_KeyDown"
        MouseDoubleClick="Gengrid_MouseDoubleClick"
        x:Name="Gengrid">
    <Window.Resources>

        <conv:IncreaseByParamValue x:Key="IncreaseByParamValue" />
        <conv:ReduceByParamValue x:Key="ReduceByParamValue"/>

        <!--#treeview stuff-->
        <!--<model:SqlDatabases x:Key="DbNames"/>-->
        <!--
        <Viewmodels:Databases x:Key="DbNames"/>
        -->
        <!--<model:Database x:Key="DbNames"/>-->
        <!--<DataTemplate DataType="{x:Type models:SqlTable}">-->
        <!--
        <DataTemplate x:Key="Level2">
            <TextBlock Text="{Binding Path=Tablename}" />
        </DataTemplate>

        -->
        <!--<HierarchicalDataTemplate  DataType="{x:Type models:Database}" >-->
        <!--
        <HierarchicalDataTemplate  x:Key="Level1" 
						   ItemsSource="{Binding DbNames}"
						   ItemTemplate="{StaticResource Level2}">
            <TextBlock Text="{Binding Path=Databasename}" />
        </HierarchicalDataTemplate>-->

        <!--#endtreeview stuff-->

        <!--#region magic color brushes-->

        <LinearGradientBrush x:Key="VerticalRainbow" StartPoint="0,1" EndPoint="0,0">
            <GradientStop Color="Red" Offset="1.0"/>
            <GradientStop Color="Yellow" Offset="0.4"/>
            <GradientStop Color="Black" Offset="0.5"/>
            <GradientStop Color="Lime" Offset="0.7"/>
            <GradientStop Color="Red"  Offset="0.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="HorizontalRainbow" StartPoint="1,0" EndPoint="0,0">
            <GradientStop Color="Red" Offset="1.0"/>
            <GradientStop Color="Yellow" Offset="0.4"/>
            <GradientStop Color="Black" Offset="0.5"/>
            <GradientStop Color="Lime" Offset="0.7"/>
            <GradientStop Color="Red"  Offset="0.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="VerticalGraduated" StartPoint="1, 0" EndPoint="0, 0">
            <GradientStop Color="Black" Offset="1"/>
            <GradientStop Color="Black" Offset="0.9"/>
            <GradientStop Color="Lime" Offset="0.7"/>
            <GradientStop Color="Lime" Offset="0.6"/>
            <GradientStop Color="Black" Offset="0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="HorizontalGraduated" StartPoint="0, 1" EndPoint="0, 0">
            <GradientStop Color="Black" Offset="1"/>
            <GradientStop Color="Lime" Offset="0.5"/>
            <GradientStop Color="Black" Offset="0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="HSplitterRainbow" StartPoint="1,0" EndPoint="0,0">
            <GradientStop Color="Red" Offset="1.0"/>
            <GradientStop Color="Lime" Offset="0.85"/>
            <GradientStop Color="Yellow" Offset="0.82"/>
            <GradientStop Color="Black" Offset="0.65"/>
            <GradientStop Color="Black" Offset="0.45"/>
            <GradientStop Color="Yellow" Offset="0.18"/>
            <GradientStop Color="Lime" Offset="0.15"/>
            <GradientStop Color="Red"  Offset="0.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="DiagonalRainbow" StartPoint="0,0.0" EndPoint="1,0.9">
            <GradientStop Color="Red" Offset="1.0"/>
            <GradientStop Color="Yellow" Offset="0.4"/>
            <GradientStop Color="Black" Offset="0.5"/>
            <GradientStop Color="Lime" Offset="0.7"/>
            <GradientStop Color="Red"  Offset="0.0"/>
        </LinearGradientBrush>

        <LinearGradientBrush x:Key="Horizontalgradientredblack" StartPoint="0,0.0" EndPoint="1,0.9">
            <GradientStop Color="Red" Offset="1.0"/>
            <GradientStop Color="White" Offset="0.8"/>
            <GradientStop Color="Black" Offset="0.5"/>
            <GradientStop Color="White" Offset="0.25"/>
            <GradientStop Color="Red" Offset="0.0"/>
            <!--<GradientStop Color="Lime" Offset="0.7"/>
            <GradientStop Color="Red"  Offset="0.0"/>-->
        </LinearGradientBrush>

        <!--#endregion magic color brushes-->

        <!--//**************************************************************************//-->

        <!--#region Styles-->

        <Style x:Key="StackPanelStyle1" TargetType="{x:Type StackPanel}">
            <Setter Property="Width" Value="425"/>

            <Style.Triggers>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="false"/>
                    </MultiTrigger.Conditions>
                    <MultiTrigger.Setters>
                        <Setter Property="Background" Value="{StaticResource White3}"/>
                        <Setter Property="TextElement.Foreground"  Value="{StaticResource Black0}"/>
                        <Setter Property="Height" Value="25"/>
                    </MultiTrigger.Setters>
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                    </MultiTrigger.Conditions>
                    <MultiTrigger.Setters>
                        <Setter Property="Background" Value="{StaticResource Red1}"/>
                        <Setter Property="TextElement.FontWeight" Value="DemiBold"/>
                        <Setter Property="TextElement.FontStyle" Value="Italic"/>
                        <Setter Property="TextElement.Foreground"  Value="{StaticResource White0}"/>
                        <Setter Property="Height" Value="25"/>
                    </MultiTrigger.Setters>
                </MultiTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="YellowTextGradient" TargetType="TextBlock">
            <Style.Triggers>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="Button.IsMouseOver" Value="False"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="TextElement.Foreground" >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="White" Offset="1.0"/>
                                <GradientStop Color="Yellow" Offset="0.0"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="TextElement.Background" >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FF684900" Offset="1.0"/>
                                <GradientStop Color="#FFAB9300" Offset="0"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="TextElement.Background"  >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FF684900" Offset="0.414"/>
                                <GradientStop Color="{StaticResource ClrWhite4}" Offset="0.953"/>
                                <!--<GradientStop Color="#FF0000" Offset="1"/>-->
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>

                    <Setter Property="TextElement.Foreground"  >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="1,0" EndPoint="0,0">
                                <!--<GradientStop Color="#FF684900" Offset="1.0"/>-->
                                <GradientStop Color="Black" Offset="0.0"/>
                                <GradientStop Color="Cyan" Offset="0.2"/>
                                <GradientStop Color="Cyan" Offset="0.4"/>
                                <GradientStop Color="White" Offset="1.0"/>
                                <!--<GradientStop Color="#FF0000" Offset="1"/>-->
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="SplitterComboStyle" TargetType="TextBlock">
            <Style.Triggers>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="Button.IsMouseOver" Value="False"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="TextElement.Foreground" Value="White" />
                    <Setter Property="TextElement.Background" >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FF684900" Offset="1.0"/>
                                <GradientStop Color="#FFAB9300" Offset="0"/>
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>
                <!--<MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                    </MultiTrigger.Conditions>
                    <Setter Property="TextElement.Background"  >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                <GradientStop Color="#FF684900" Offset="0.414"/>
                                <GradientStop Color="{StaticResource ClrWhite4}" Offset="0.953"/>
                                -->
                <!--<GradientStop Color="#FF0000" Offset="1"/>-->
                <!--
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>

                    <Setter Property="TextElement.Foreground"  >
                        <Setter.Value>
                            <LinearGradientBrush StartPoint="1,0" EndPoint="0,0">
                                -->
                <!--<GradientStop Color="#FF684900" Offset="1.0"/>-->
                <!--
                                <GradientStop Color="Black" Offset="0.0"/>
                                <GradientStop Color="Cyan" Offset="0.2"/>
                                <GradientStop Color="Cyan" Offset="0.4"/>
                                <GradientStop Color="White" Offset="1.0"/>
                                -->
                <!--<GradientStop Color="#FF0000" Offset="1"/>-->
                <!--
                            </LinearGradientBrush>
                        </Setter.Value>
                    </Setter>
                </MultiTrigger>-->
            </Style.Triggers>
        </Style>

        <Style x:Key="SpStringsStyle" TargetType="{x:Type ListBoxItem}">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ListBoxItem}">
                        <Border x:Name="Bd" SnapsToDevicePixels="true">

                            <ContentPresenter x:Name="Contentpresenter" HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}" 
                                                SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                                VerticalAlignment="{TemplateBinding VerticalContentAlignment}"/>

                        </Border>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="False"/>
                                    <Condition Property="IsSelected" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Black3}"/>
                                <Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource White0}"/>
                                <Setter Property="Padding" TargetName="Bd" Value="10,0,0,0"/>
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="true"/>
                                    <Condition Property="IsSelected" Value="true"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Yellow0}"/>
                                <Setter Property="TextElement.Foreground" TargetName="Bd" Value="{StaticResource Red0}"/>
                                <Setter Property="Padding" TargetName="Bd" Value="10,0,0,0"/>
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="False"/>
                                    <Condition Property="IsSelected" Value="true"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Red5}"/>
                                <Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource White0}"/>
                                <Setter Property="Padding" TargetName="Bd" Value="10,0,0,0"/>
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="true"/>
                                    <Condition Property="IsSelected" Value="false"/>
                                </MultiTrigger.Conditions>
                                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Orange4}"/>
                                <Setter Property="TextElement.Foreground" TargetName="Contentpresenter" Value="{StaticResource Black0}"/>
                                <Setter Property="Padding" TargetName="Bd" Value="10,0,0,0"/>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                        <!--more ....-->
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="MenuItemBlue" TargetType="{x:Type MenuItem}">
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="Black" />
            <!--<Setter Property="BorderBrush" Value="{StaticResource HeaderBorderBrushYellow}" />-->
            <Setter Property="BorderThickness" Value="1.5" />
            <Setter Property="SnapsToDevicePixels" Value="False" />
            <Setter Property="HorizontalContentAlignment" Value="left" />
            <Setter Property="VerticalAlignment" Value="Bottom" />
            <Setter Property="VerticalContentAlignment" Value="Bottom" />
            <Setter Property="MinHeight" Value="25" />
            <!--<Setter Property="Cursor" Value="Hand" />-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <Border x:Name="Bd" 
							  Padding="17,0,17,0" 
							  BorderBrush="{TemplateBinding BorderBrush}" 
							  BorderThickness="{TemplateBinding BorderThickness}" 
							  Background="{TemplateBinding Background}" 
							  SnapsToDevicePixels="False" 
							  Uid="Border_38">
                            <ContentPresenter x:Name="ContentPresenter"  
										Content="{TemplateBinding Header}" 
										Margin="{TemplateBinding Padding}" 
										RecognizesAccessKey="True" 
										SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
										Uid="ContentPresenter_33"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsHighlighted" Value="True">
                                <Setter Property="Height" TargetName="Bd" Value="25"/>
                                <Setter Property="BorderBrush" TargetName="Bd" Value="{StaticResource Blue2}"/>
                                <Setter Property="Background" TargetName="Bd" Value="{StaticResource Blue2}"/>
                                <Setter Property="TextElement.Foreground"  Value="{StaticResource White0}"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!--- Dont understand why it has to be mouseover=false & ExitAction, but it works that way, not if true-->
        <Style TargetType="ComboBox" x:Key="ComboBoxStyle5">
            <Style.Triggers>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="False"/>
                    </MultiTrigger.Conditions>
                    <MultiTrigger.Setters>
                        <Setter Property="Background" Value="Red"/>
                        <Setter Property="Foreground" Value="White"/>
                    </MultiTrigger.Setters>
                </MultiTrigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsMouseOver" Value="True"/>
                    </MultiTrigger.Conditions>
                    <MultiTrigger.Setters>
                        <Setter Property="Background" Value="Red"/>
                        <Setter Property="Foreground" Value="White"/>
                    </MultiTrigger.Setters>
                </MultiTrigger>
            </Style.Triggers>
        </Style>

  
        <Style x:Key="DefaultCancelButton" TargetType="{x:Type Button}">
            <!--Default layout-->
            <Setter Property="OverridesDefaultStyle" Value="True" />
            <!--These defaults can be overriden by the Button Code in the design-->
            <Setter Property="Height" Value="50" />
            <Setter Property="Width" Value="150" />
            <Setter Property="BorderBrush" Value="Black" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="1" />
            <Setter Property="FontSize" Value="16" />
            <Setter Property="FontWeight" Value="SemiBold" />
            <!--<Setter Property="Background" Value="{StaticResource Red5}">-->
            <!--<Setter.Value>
                    <LinearGradientBrush 
                                    StartPoint="0.2, 0" EndPoint="0, 1">
                        <GradientStop Offset="0" Color="#DF000000" />
                        <GradientStop Offset="4" Color="#69000000" />
                        <GradientStop Offset="0.5" Color="#69EB5E00" />
                        <GradientStop Offset="6" Color="#69000000" />
                        <GradientStop Offset="1" Color="#DF000000" />
                    </LinearGradientBrush>
                </Setter.Value>-->
            <!--</Setter>-->
            <!--Lets change the Border as well but use the colors
			defined in the Buttons declaration in the xaml code-->

            <Setter Property="Control.Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type Button}">
                        <Border  x:Name="border"
						Background="{TemplateBinding Background}"
						BorderBrush="{TemplateBinding BorderBrush}"
						BorderThickness="{TemplateBinding BorderThickness}"
						CornerRadius="3,3,3,3">
                            <ContentPresenter
							Margin="2"
							HorizontalAlignment="Center"
							VerticalAlignment="Center"
							RecognizesAccessKey="True" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>

            <!--Now to handle those pesky Triggers-->
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="False">
                    <Setter Property="TextElement.Foreground"  Value="{StaticResource White0}"/>
                    <Setter Property="BorderBrush"  Value="{StaticResource Black0}"/>
                    <Setter Property="BorderThickness"  Value="3"/>
                    <Setter Property="FontSize"  Value="14"/>
                    <Setter Property="Control.Background" Value="{StaticResource Red5}"/>
                </Trigger>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="TextElement.Foreground"  Value="{StaticResource Yellow0}"/>
                    <Setter Property="BorderBrush"  Value="{StaticResource Black0}"/>
                    <Setter Property="BorderThickness"  Value="3"/>
                    <Setter Property="FontSize"  Value="14"/>
                    <Setter Property="Control.Background" Value="{StaticResource Orange0}"/>
                </Trigger>
                <Trigger Property="IsPressed" Value="True">
                    <Setter Property="Background">
                        <Setter.Value>
                            <!--Makes gradient fill work horizontally-->
                            <RadialGradientBrush Center="0.5, 1.0">
                                <GradientStop Offset="0" Color="Beige" />
                                <GradientStop Offset="1" Color="Green" />
                            </RadialGradientBrush>
                        </Setter.Value>
                    </Setter>
                    <Setter Property="Foreground" Value="Black"/>
                </Trigger>
                <MultiTrigger>
                    <MultiTrigger.Conditions>
                        <Condition Property="IsEnabled" Value="False"/>
                    </MultiTrigger.Conditions>
                    <MultiTrigger.Setters>
                        <Setter Property="Background">
                            <Setter.Value>
                                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                                    <GradientStop Color="LightGray" Offset="0.35" />
                                    <GradientStop Color="DarkGray" Offset="1" />
                                </LinearGradientBrush>
                            </Setter.Value>
                        </Setter>
                    </MultiTrigger.Setters>
                </MultiTrigger>
            </Style.Triggers>
        </Style>

        <Style x:Key="BankAccountGridStyle" TargetType="DataGridCell" BasedOn="{StaticResource {x:Type DataGridCell}}">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush 
                                    StartPoint="0.2, 0" EndPoint="0, 1">
                        <GradientStop Offset="0" Color="#DF000000" />
                        <GradientStop Offset="4" Color="#69000000" />
                        <GradientStop Offset="0.5" Color="#69EB5E00" />
                        <GradientStop Offset="6" Color="#69000000" />
                        <GradientStop Offset="1" Color="#DF000000" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Style.Triggers>

                <!--#region Special Triggers for Generic style Tables-->
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="False" />
                        <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" Value="False" />
                    </MultiDataTrigger.Conditions>
                    <MultiDataTrigger.Setters>
                        <Setter Property="Background" Value="Transparent" />
                        <Setter Property="Foreground" Value="{StaticResource Black0}" />
                        <Setter Property="FontWeight" Value="SemiBold" />
                    </MultiDataTrigger.Setters>
                </MultiDataTrigger>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="True" />
                        <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" Value="false" />
                    </MultiDataTrigger.Conditions>
                    <MultiDataTrigger.Setters>
                        <Setter Property="Background" Value="{StaticResource Red0}" />
                        <Setter Property="Foreground" Value="{StaticResource White0}" />
                        <Setter Property="FontWeight" Value="DemiBold" />
                    </MultiDataTrigger.Setters>
                </MultiDataTrigger>
                <MultiDataTrigger>
                    <MultiDataTrigger.Conditions>
                        <Condition Binding="{Binding RelativeSource={RelativeSource Self}, Path=IsSelected}" Value="false" />
                        <Condition Binding="{Binding RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=DataGridRow}, Path=IsMouseOver}" Value="true" />
                    </MultiDataTrigger.Conditions>
                    <MultiDataTrigger.Setters>
                        <Setter Property="Background" Value="{StaticResource Orange1}" />
                        <Setter Property="Foreground" Value="{StaticResource White0}" />
                        <Setter Property="FontWeight" Value="DemiBold" />
                    </MultiDataTrigger.Setters>
                </MultiDataTrigger>
                <!--#endregion Special Triggers for Non Bamk/Customer Tables-->

            </Style.Triggers>
        </Style>

        <!--// "Special" style for variable content menu entry-->
        <Style x:Key="SpecialSelection" TargetType="{x:Type MenuItem}">
            <Setter Property="Background" Value="{StaticResource White3}" />
            <Setter Property="Foreground" Value="Black" />
            <Setter Property="Height"  Value="25" />
            <!--<Setter Property="BorderThickness" Value="1.5" />-->
            <Setter Property="SnapsToDevicePixels" Value="True" />
            <Setter Property="HorizontalContentAlignment" Value="left" />
            <Setter Property="VerticalAlignment" Value="Bottom" />
            <Setter Property="VerticalContentAlignment" Value="Bottom" />
            <!--<Setter Property="MinHeight" Value="25" />-->
            <!--<Setter Property="Cursor" Value="Hand" />-->
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type MenuItem}">
                        <!--BorderBrush="{TemplateBinding BorderBrush}" 
							  BorderThickness="{TemplateBinding BorderThickness}"-->
                        <Border x:Name="Bd" 
							  Padding="0,0,0,0" 
							  Background="{TemplateBinding Background}" 
							  SnapsToDevicePixels="False" 
							  Uid="Border_38">
                            <ContentPresenter x:Name="ContentPresenter"  
										Content="{TemplateBinding Header}" 
										Margin="{TemplateBinding Padding}" 
										RecognizesAccessKey="True" 
										SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" 
										Uid="ContentPresenter_33"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="false"/>
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter Property="Background"  TargetName="Bd" Value="{StaticResource Green5}"/>
                                    <Setter Property="TextElement.Foreground" TargetName="ContentPresenter" Value="{StaticResource Black0}"/>
                                    <Setter Property="Height" Value="25"/>
                                </MultiTrigger.Setters>
                            </MultiTrigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsMouseOver" Value="True"/>
                                </MultiTrigger.Conditions>
                                <MultiTrigger.Setters>
                                    <Setter Property="Background" TargetName="Bd" Value="{StaticResource Red5}"/>
                                    <Setter Property="TextElement.FontWeight" Value="DemiBold"/>
                                    <Setter Property="TextElement.FontStyle" Value="Italic"/>
                                    <Setter Property="TextElement.Foreground"  TargetName="ContentPresenter"  Value="{StaticResource Yellow1}"/>
                                    <Setter Property="Height" Value="25"/>
                                </MultiTrigger.Setters>
                            </MultiTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--#endregion Styles-->

        <!--//**************************************************************************//-->

        <!--#region  ContextMenu and support  stuff-->

        <!--// used by Context menus to hide the image area at left-->
        <ItemsPanelTemplate x:Key="NoImageMenu">
            <StackPanel Margin="-40,0,0,0" Background="{StaticResource Cyan1}" />
        </ItemsPanelTemplate>
        <!--//**************************************************************************//-->

        <!--//Menu for datagrid view-->
        <ContextMenu  x:Key="GenGridContextMenu"  Width="375" 
            HasDropShadow="True"
            ContextMenuService.Placement="Center"
            ContextMenuService.VerticalOffset="-10"
                  Closed="ContextMenu_Closed"
            Background="Orange">

            <!--// template that removes  that annoying image panel at left of context menus-->
            <ContextMenu.Style>
                <Style TargetType="{x:Type ContextMenu}">
                    <Setter Property="ItemsPanel" Value="{StaticResource NoImageMenu}"/>
                </Style>
            </ContextMenu.Style>

            <MenuItem x:Name="gm1" Click="MenuItem_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Switch to Sql Tables viewer"
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
                <!--<MenuItem.Icon>
                        <Image Source="/Icons/progressSkip.ico" Height="15" Width="25" />
                    </MenuItem.Icon>-->
            </MenuItem>

            <MenuItem  x:Name="gm2"  Click="ShowInfo">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Switch to Info/S.Procedures Viewer"
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm3" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                    Foreground="Red"
                                     Height="12"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm4" Click="MenuItem_Click" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="^v Show Sql tables viewer full size" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm5" Click="ReloadInfo" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="^v Show Info/S.P Viewer panel full size"
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm6" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                    Foreground="Red"
                                     Height="12"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm7" Click="ShowColumnInfo_Click" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Show full schema for table" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm8" Click="ShowFilter_Click" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Filter current table to new table" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm21" Click="ShowlocalFilter_Click" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Filter current table to Display only" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm9" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                  Text="------------------------------------------------------------------------"
                                FontSize="8"
                                    Foreground="Red"
                                     Height="12"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm10" Click="SaveAsNewTable" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Save table to a new table" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm11" Click="ReloadTables" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Reload List of tables" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm12" Click="SearchStoredProc" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Find text in All Stored Procedures" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm13" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                    Foreground="Red"
                                     Height="12"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="gm14" Click="LoadAllDatabases" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Switch to different SQL Database" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>
        </ContextMenu>

        <!--//**************************************************************************//-->

        <!--//Menu for Sp Viewer-->
        <ContextMenu x:Key="PopupMenu"
                HasDropShadow="True"
                Background="Transparent"
                Opened="ContextMenu_Opened"
                Closed="InfoContextMenu_Closed"
                Padding="-40 0 -40 0"
                 DataContext="{Binding Gengrid}"
                IsOpen="false"
                Width="425">
            <!--The width above sets the OVERALL menu width-->
            <ContextMenu.Style>
                <Style TargetType="{x:Type ContextMenu}">
                    <Setter Property="ItemsPanel" Value="{StaticResource NoImageMenu}"/>
                </Style>
            </ContextMenu.Style>

            <ContextMenu.ItemsPanel>
                <ItemsPanelTemplate>
                    <VirtualizingStackPanel/>
                </ItemsPanelTemplate>
            </ContextMenu.ItemsPanel>

            <MenuItem x:Name="cm1" FontSize="16" Foreground=" White" Click="MenuItem_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="^v Show Sql tables viewer full size" 
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm2" FontSize="16" Foreground=" Black" Click="ReloadInfo">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="^v Show Info/S.P Viewer panel full size" 
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm3" FontSize="16" IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                Foreground="{StaticResource Red0}" 
                                FontSize="8"
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm16" FontSize="16" Foreground=" Black" Click="LoadSpResultsAll"  IsEnabled="{Binding ExecuteLoaded}">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Show Show S.P's Execution Window (All SP's)" 
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"                               
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm17" FontSize="16" Foreground=" Black" Click="LoadSpResultsMatch"  IsEnabled="{Binding ExecuteLoaded}">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Show S.P's Execution Window (Matching SP's)" 
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm18" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                Foreground="{StaticResource Red0}" 
                                FontSize="8"
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm4" FontSize="16" Click="LoadAllSPs_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Load ALL available S.P's into list"
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm5" FontSize="16" Click="LoadMatchingSPs_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Load only S.P's that match Search term into list"    
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>


            <MenuItem x:Name="cm6" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                Foreground="{StaticResource Red0}" 
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm7" FontSize="16" Click="Fontsizeup_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Increase viewer Font Size (Press +)"    
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm8" FontSize="16" Click="Fontsizedn_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Decrease viewer Font Size (Press -)"    
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm9" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                Foreground="{StaticResource Red0}" 
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm10" FontSize="16" Click="ChangeMatchingSPs_Click">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Change the current matching Search term "    
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm11" FontSize="16" Foreground="{StaticResource Green0}" Click="ReloadTables">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="ReLoad Table Selection Combo with ALL Sql Tables"
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm21" 
                      FontSize="16" 
                      Foreground="{StaticResource Green0}" 
                      Click="LoadViewerTables">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="View ALL Sql Tables"
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <!--// reload ALL SP.s-->
            <MenuItem x:Name="cm12" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                Foreground="{StaticResource Red0}" 
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem  x:Name="cm13" FontSize="16" Foreground=" Black" Click="LoadTechInfo">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="Load Technical Info about this control" 
                                FontSize="16"
                                Height="25"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm14" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                Foreground="{StaticResource Red0}" 
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem   x:Name="cm19" Click="LoadAllDatabases" >
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                    Text="Switch to different SQL Database" 
                                    FontSize="16"
                                     Height="25"
                                    Padding="20 0 0 0"
                                    Margin="0 0 0 0"
                                     Width="375"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <MenuItem x:Name="cm20" FontSize="16"  IsEnabled="false">
                <MenuItem.Header>
                    <StackPanel Orientation="Horizontal" Style="{StaticResource StackPanelStyle1}">
                        <TextBlock 
                                Text="------------------------------------------------------------------------"
                                FontSize="8"
                                Foreground="{StaticResource Red0}" 
                                Height="15"
                                Padding="20 0 0 0"
                                Margin="0 0 0 0"
                                Width="425"/>
                    </StackPanel>
                </MenuItem.Header>
            </MenuItem>

            <!--Background="{StaticResource White5}"-->
            <!--Foreground="{StaticResource Red5}"-->
            <!--Background="{StaticResource White3}"-->
            <MenuItem x:Name="cm15" 
                    Height="25"
                    Padding="20 0 0 0"
                    FontSize="16" 
                    Width="425"                      
                    Click="ExecuteSP_Click"
                    Style="{StaticResource SpecialSelection}"
                    Header="{Binding SPExecuteText}">
            </MenuItem>


        </ContextMenu>

        <!--#endregion  ContextMenu stuff-->

    </Window.Resources>

    <!--//***********************************************************************************************//-->

    <!--<Grid x:Name="maingrid" Background="{StaticResource DiagonalRainbow}"-->
    <Grid x:Name="maingrid" Background="{StaticResource Black2OrangeSlant}"
          LostFocus="FieldSelectionGrid_LostFocus" Opacity="0.9" Panel.ZIndex="0">
        <Grid.RowDefinitions>
            <RowDefinition  x:Name="row1" Height="1"/>
            <RowDefinition x:Name="row2" Height="*"/>
            <RowDefinition  x:Name="row5" Height="175"/>
            <!--//Splitter-->
        </Grid.RowDefinitions>

        <!--****************-->
        <!--#region Canvas  / Splitters etc-->
        <!--****************-->
        <Canvas x:Name="Filtercanvas"
                Panel.ZIndex="255" 
                Margin="0,1,0,120"
                Width="{Binding ActualWidth, ElementName=maingrid}"
                Height="{Binding ActualHeight, ElementName=maingrid, Converter={StaticResource ReduceByParamValue},ConverterParameter=175}"
                LostFocus="FieldSelectionGrid_LostFocus" 
                Grid.Row="1"
                Visibility="Visible">

            <Grid x:Name="FieldSelectionGrid" 
                    Grid.Row="1" Grid.RowSpan="3" Width="450"
                    Panel.ZIndex="256"  
                    LostFocus="FieldSelectionGrid_LostFocus"
                    Background="{StaticResource Cyan4}"
                    HorizontalAlignment="Center" 
                    Height="430"                   
                      Canvas.Top="30" 
                    PreviewMouseLeftButtonDown="ColSelect_DragDialog_LButtonDn"
                    PreviewMouseLeftButtonUp="ColSelect_DragDialog_Ending"
                    PreviewMouseMove="ColSelect_DragDialog_Moving"
                    VerticalAlignment="Top"
                    Visibility="Collapsed" >
                <Grid.RowDefinitions>
                    <RowDefinition Height="25"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="30"/>
                    <RowDefinition Height="45"/>
                </Grid.RowDefinitions>

                <TextBlock x:Name="Banner" 
                       Grid.Row="0"
                       Text="Save to new table - Columns Selection Utility"
                       TextAlignment="Center"
                       Padding="0 2 0 0"
                       Margin="0 0 0 0"
                        FontSize="14"
                        HorizontalAlignment="Stretch"                           
                       Background="{StaticResource Blue1}"
                        PreviewMouseLeftButtonDown="DragDialog_LButtonDn"
                        PreviewMouseLeftButtonUp="DragDialog_Ending"
                        PreviewMouseMove="DragDialog_Moving"
                       Foreground="White" UseLayoutRounding="True"/>

                <DataGrid x:Name="ColNames"
                        Grid.Row="1"
                        SelectionMode="Extended"
                        FontSize="16"
                        HorizontalAlignment="Stretch"
                        SelectionChanged="ColNames_SelectionChanged"
                        Margin="10,10,10,9" >
                </DataGrid>

                <TextBlock x:Name="Prompt" 
                       Grid.Row="2"
                       Text="Use Ctrl+Click to select each column you want included..."
                       TextAlignment="Center"
                               Height="25"
                       Padding="0 2 0 0"
                       Margin="10 0 10 5"
                        FontSize="14"
                           FontWeight="DemiBold"
                        HorizontalAlignment="Stretch"                           
                       Background="{StaticResource Blue5}"
                        PreviewMouseLeftButtonDown="DragDialog_LButtonDn"
                        PreviewMouseLeftButtonUp="DragDialog_Ending"
                        PreviewMouseMove="DragDialog_Moving"
                       Foreground="Red" 
                        UseLayoutRounding="True"/>

                <Button x:Name="GoBtn" 
                       Grid.Row="3"
                        Width="130" Height="35" 
                        FontSize="16"
                        HorizontalAlignment="Right"
                        Margin="0, 0,10,3"
                        VerticalAlignment="Center"
                        Content="Go!"
                        Click="GoBtn_Click"
                        Background="Green" 
                            Foreground="Red" />

                <Button x:Name="stopBtn" 
                        Width="100" Height="35" 
                        FontSize="16"
                        HorizontalAlignment="Right" 
                        Margin="0,0,150,3"
                        VerticalAlignment="Center"
                        Content="Cancel"
                        Click="stopBtn_Click"
                        Background="Red" Foreground="White" Grid.Row="3"/>

            </Grid>
            <!--#endregion colmn selection-->

            <!--Filering-->
            <!--#region Filtering-->
            <Grid x:Name="Filtering" 
                Grid.Row="1" 
                Grid.RowSpan="5" 
                Background="Cyan"  
                PreviewMouseLeftButtonDown="Filtering_DragDialog_LButtonDn"
                PreviewMouseLeftButtonUp="Filtering_DragDialog_Ending"
                PreviewMouseMove="Filtering_DragDialog_Moving"
                LostFocus="FieldSelectionGrid_LostFocus"
                Panel.ZIndex="256"
                Canvas.Left="213"
                Canvas.Top ="46"
                KeyDown="Filtering_KeyDown"
                HorizontalAlignment="Center" 
                VerticalAlignment="Top" 
                  Height="211" 
                  Width="497" 
                Visibility="Collapsed" >

                <Grid.RowDefinitions>
                    <RowDefinition Height="119*"/>
                    <RowDefinition Height="117*"/>
                </Grid.RowDefinitions>

                <Border x:Name="filterdlg"
                    Grid.Row="0" Grid.RowSpan="2"
                    BorderBrush="{StaticResource Red3}" 
                    BorderThickness="2 30 2 15" 
                    LostFocus="FieldSelectionGrid_LostFocus"
                    Height="{Binding ActualHeight, ElementName=Filtering}"
                    Width="{Binding ActualWidth, ElementName=Filtering}"
                    Visibility="Visible">
                    <StackPanel>

                        <TextBlock x:Name="FilterBanner"
                            Text="Generic Table Viewer - Filtering System"
                            Height="21"
                            Padding="0 0 0 0"
                            VerticalAlignment="Top"
                            Margin="10 -26,10 0"
                            FontSize="16"
                            FontWeight="DemiBold"
                            TextWrapping="Wrap" 
                            Background="{StaticResource Orange4}" 
                            LostFocus="FieldSelectionGrid_LostFocus"
                            TextAlignment="Center"
                            Foreground="Black" 
                            Visibility="Visible"/>

                        <Grid
                                Height="{Binding ActualHeight, ElementName=Filterdlg}"
                                Width="{Binding ActualWidth, ElementName=Filterdlg}"
                                LostFocus="FieldSelectionGrid_LostFocus">

                            <TextBlock x:Name="FilterText"
                                    Text="    Enter a fully qualified SQL fllter clause (WITHOUT the 'Where' clause part) into the field below"
                                    Height="39"
                                    Padding="5 0 0 5"
                                    VerticalAlignment="Top"
                                    Margin="0,5,8,0"
                                    FontSize="16"
                                    FontWeight="DemiBold"
                                    TextWrapping="Wrap" 
                                    Background="Transparent" 
                                    LostFocus="FieldSelectionGrid_LostFocus"
                                    TextAlignment="Center"
                                    Foreground="Black" 
                                    Visibility="Visible"/>

                            <Label Content="Where" 
                                        Height="30" Width="56" 
                                        FontSize="16" 
                                        FontWeight="DemiBold"
                                        HorizontalAlignment="Left" 
                                        VerticalAlignment="Top"
                                        LostFocus="FieldSelectionGrid_LostFocus"
                                        Foreground="Black" 
                                        Background="{StaticResource Cyan2}"
                                        Margin="10,71,0,0"
                                        Padding="5 3 0 0"
                                        Visibility="Visible"/>

                            <TextBox x:Name="filtertext" 
                                        Background="{StaticResource White1}" 
                                        CaretBrush="Blue" 
                                        Foreground="Red"
                                        Focusable="True"
                                        Height="51" Width="408" 
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Top"
                                        TextAlignment="Center" 
                                        TextWrapping="Wrap"
                                        Margin="78,57,0,0" 
                                        LostFocus="FieldSelectionGrid_LostFocus"     
                                        Padding="5 1 5 0" 
                                        FontSize="16" 
                                        Text="Enter SQL filtering code here ...."
                                        Visibility="Visible" TabIndex="1"/>

                            <TextBlock x:Name="prompt2" 
                                        Background="Transparent" 
                                          Foreground="Blue"
                                        Focusable="True" Width="347" 
                                        HorizontalAlignment="Left"
                                        TextAlignment="Center" 
                                        TextWrapping="Wrap"
                                        Margin="85,112,0,0" 
                                        LostFocus="FieldSelectionGrid_LostFocus"     
                                        Padding="5 1 5 0" 
                                        FontSize="18" 
                                       FontWeight="DemiBold"
                                        Text="Press ENTER to apply the filter entered , or Escape to cancel...."
                                        Visibility="Visible" Height="58" VerticalAlignment="Top" />

                            <Button Height="35" Width="120 "
                                        Click="Filter_Click"
                                        Style="{StaticResource ButtonSlant}"
                                        Foreground="White" 
                                        Content="Apply Filter" 
                                        Margin="0,0,10,-46" 
                                         LostFocus="FieldSelectionGrid_LostFocus"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Bottom"
                                        Visibility="Collapsed"/>

                            <Button Height="35" Width="120 " 
                                        Click="closeFilter"
                                        Foreground="LightGreen" 
                                        Style="{StaticResource ButtonSlant}"
                                        Content="Cancel" 
                                        Margin="0,0,140,-46" 
                                    KeyDown="Button_KeyDown"
                                        LostFocus="FieldSelectionGrid_LostFocus"
                                        HorizontalAlignment="Right"
                                        VerticalAlignment="Bottom"
                                        Visibility="Collapsed"/>
                        </Grid>
                    </StackPanel>
                </Border>
            </Grid>
            <!--//************************//-->
            <!--#endregion Filtering-->

            <!--smaller text search dialog-->
            <!--#region StringSearchResults-->
            <!--************************************-->
            <Grid x:Name="SpStringsSelection"
                Height="237" 
                Width="379"
                Canvas.Top="31" 
                Canvas.Left="211"    
                Panel.ZIndex="256"  
                PreviewMouseRightButtonDown="closeSearchDlg"
               MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
               MouseLeftButtonUp="Search2_DragDialog_Ending"
               MouseMove="Search2_DragDialog_Moving"
                Focusable="True"
                Visibility="Collapsed" 
                HorizontalAlignment="Center" 
                VerticalAlignment="Top" >

                <Border x:Name="StringSelectionBorder"
                        BorderThickness="5" 
                        BorderBrush="Purple"
                        KeyDown="SpStringsSelection_KeyDown"
                        LostFocus="FieldSelectionGrid_LostFocus"                    
                        PreviewMouseRightButtonDown="closeSearchDlg"
                        MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                        MouseLeftButtonUp="Search2_DragDialog_Ending"
                        MouseMove="Search2_DragDialog_Moving"
                       HorizontalAlignment="Center"
                        VerticalAlignment="Center" 
                        Visibility="Visible"
                    Height="240">
                    <Grid 
                            Grid.Row="1" 
                            Height="230" 
                            Width="375"
                           LostFocus="FieldSelectionGrid_LostFocus"
                            MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                            MouseLeftButtonUp="Search2_DragDialog_Ending"
                            MouseMove="Search2_DragDialog_Moving"
                            Background="{StaticResource Cyan3}"
                            PreviewMouseRightButtonDown="closeSearchDlg"
                            HorizontalAlignment="Center" 
                            VerticalAlignment="Top"
                            Visibility="Visible" >

                        <Grid.RowDefinitions>
                            <RowDefinition Height="300"/>
                            <RowDefinition Height="200"/>
                        </Grid.RowDefinitions>

                        <TextBlock 
                            Grid.Row="0"
                            Text="Stored Procedure Search Utility"
                            TextAlignment="Center"
                            Padding="0 2 0 0"
                            Margin="4,0,4,0"     
                            Foreground="White"
                            Background="Purple"
                            FontSize="16"
                            PreviewMouseRightButtonDown="closeSearchDlg"
                            MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                            MouseLeftButtonUp="Search2_DragDialog_Ending"
                            MouseMove="Search2_DragDialog_Moving"
                            TextWrapping="Wrap"
                            UseLayoutRounding="True" 
                            Height="30"
                            VerticalAlignment="Top" 
                            RenderTransformOrigin="0.5,0.5"/>

                        <TextBlock 

                            Text="Enter the exact text you want to find in any of the Stored Procedures in the field below..."
                            TextAlignment="Center"
                            Padding="0 2 0 0"
                            Margin="33,38,22,0"     
                            Foreground="Black"
                            FontSize="16"
                            PreviewMouseRightButtonDown="closeSearchDlg"
                            MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                            MouseLeftButtonUp="Search2_DragDialog_Ending"
                            MouseMove="Search2_DragDialog_Moving"
                            TextWrapping="Wrap"
                            UseLayoutRounding="True" 
                            Height="47" 
                            VerticalAlignment="Top" 
                            RenderTransformOrigin="0.5,0.5">
                        </TextBlock>

                        <TextBox x:Name="selectedSp"
                                Margin="11,90,9,133"
                                Text="Enter Search term here ..."
                                TextAlignment="Center"                                 
                                Focusable="True"
                                Padding="0 4 0 0"
                                FontWeight="Bold"
                                AcceptsReturn="False" 
                                AcceptsTab="True" 
                                PreviewMouseRightButtonDown="closeSearchDlg"
                                MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                                MouseLeftButtonUp="Search2_DragDialog_Ending"
                                MouseMove="Search2_DragDialog_Moving"
                                ClipToBounds="True" 
                                UseLayoutRounding="True"
                                FontSize="18" 
                                TextChanged="selectedSp_TextChanged" />

                        <Button x:Name="GoBtn1" 
                                Width="140" Height="40" 
                                HorizontalAlignment="Right" 
                                Margin="0,180,7,0"
                                VerticalAlignment="Top"
                                 Content="Save Search Term"
                                Command="{Binding FilterStoredprocs}"
                                MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                                MouseLeftButtonUp="Search2_DragDialog_Ending"
                                MouseMove="Search2_DragDialog_Moving"
                                Style="{StaticResource ButtonSlant}"                                
                                Visibility="Visible"
                                Click="GoBtn1_Click"
                                Foreground="White"/>

                        <Button x:Name="stopBtn1" 
                                Width="100" Height="40" 
                                HorizontalAlignment="Left" Margin="120,179,0,0"
                                VerticalAlignment="Top"
                                  Style="{StaticResource ButtonSlant}"
                                Content="Cancel"
                                KeyDown="stopBtn1_KeyDown"
                                Click="stopBtn1_Click"
                                MouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                                MouseLeftButtonUp="Search2_DragDialog_Ending"
                                MouseMove="Search2_DragDialog_Moving"
                                Command="{Binding CloseFilterStoredprocs}"
                                Visibility="Visible"
                                Foreground="Orange"/>

                        <CheckBox x:Name="Autoclose" Content="Close on selection"
                            VerticalAlignment="Bottom"
                            IsChecked="false"
                            FontSize="14"
                            Margin="11,0,0,56" 
                            HorizontalAlignment="Left" 
                            Width="133"
                                  Visibility="Collapsed"/>
                    </Grid>
                </Border>
            </Grid>
            <!--#endregion StringSearchResults-->

            <!--// NOT USED ANY MORE-->
            <!--#region SPselectiondialog-->
            <!--************************************-->

            <!--// This is the larger dialog that allow selection from any SP's that 
            //have returned after the SQL search has been completd-->
            <Grid x:Name="SpStringsSelector" 
                Height="314" 
                Width="365"
                KeyDown="SpStrings_KeyDown"                    
                PreviewMouseLeftButtonDown="Search2_DragDialog_LButtonDn"
                PreviewMouseLeftButtonUp="Search2_DragDialog_Ending"
                PreviewMouseMove="Search2_DragDialog_Moving"
                Canvas.Top="30" 
                Canvas.Left="250"
                Focusable="True"
                Panel.ZIndex="256"  
                LostFocus="FieldSelectionGrid_LostFocus"
                Visibility="Collapsed">

                <Border 
                    BorderThickness="3" BorderBrush="Red"
                    Visibility="Visible">

                    <Grid x:Name="FilterInnerGrid"
                            Grid.Row="1" 
                            Height="{Binding ActualHeight, ElementName=SpStringsSelector}" 
                            Width="{Binding ActualWidth, ElementName=SpStringsSelector}"                         
                            Margin="0 0 0 0"
                            PreviewMouseLeftButtonDown="DragDialog_LButtonDn"
                            PreviewMouseMove="DragDialog_Moving"
                            LostFocus="FieldSelectionGrid_LostFocus"
                            Background="{StaticResource Cyan0}"
                            HorizontalAlignment="Center" 
                            VerticalAlignment="Top"
                          Visibility="Visible">

                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="35"/>
                            <RowDefinition Height="35"/>
                        </Grid.RowDefinitions>

                        <TextBlock x:Name="Infopanel" 
                               Grid.Row="0"
                               Text="ALL Stored procedures that contain the Search term..."
                               TextAlignment="Center"
                               Padding="0 4 0 0"
                               Margin="0,0,0,215"
                               Background="Red"
                               Foreground="White" UseLayoutRounding="True"/>

                        <ListBox x:Name="ProcNames"
                                Grid.Row="0"
                                Background="{StaticResource Black7}"
                                SelectionMode="Single"
                                FontSize="16"
                                FontWeight="DemiBold"
                                 MouseDoubleClick="ProcNames_MouseDoubleClick"
                                Margin="10, 40,10,15">
                            ItemContainerStyle="{StaticResource SpStringsStyle}"
                            <ListBoxItem/>
                        </ListBox>

                        <TextBlock x:Name="Prompt2" 
                               Grid.Row="2"
                               Text="Dbl Click or Press 'Show Text' to select a procedure to be shown"
                               Height="25"
                               TextAlignment="Center"
                               Padding="0 2 0 0"
                               Margin="0 0 0 0"
                               Background="Red"
                               Foreground="White" UseLayoutRounding="True"/>

                        <TextBlock x:Name="Prompt3"
                               Text="Press ENTER to apply the filter entered above, or press Escape to cancel the Filtering operation completely"
                               TextAlignment="Center"
                                   TextWrapping="Wrap"
                               Padding="0 2 0 0"
                               Margin="0,241,0,4"
                               Background="Blue"
                               Foreground="White" UseLayoutRounding="True" Grid.RowSpan="2"/>

                        <Button x:Name="GoBtn2" 
                            Width="150" Height="30" 
                            HorizontalAlignment="Right" Margin="0,0,10,0"
                            VerticalAlignment="Top"
                            FontWeight="Normal"
                            Content="Show Text in viewer"
                            Click="GoBtn2_Click"
                            Style="{StaticResource ButtonSlant}"
                            Foreground="White" 
                                Visibility="Collapsed"
                            Grid.Row="1"/>

                        <Button x:Name="stopBtn2" 
                        Width="100" Height="30" 
                        HorizontalAlignment="Right" Margin="0,0,165,0"
                        VerticalAlignment="Top"
                        Style="{StaticResource ButtonSlant}"
                        Content="Cancel"
                        Click="stopBtn2_Click"
                                Visibility="Collapsed"
                        Foreground="Orange" Grid.Row="1"/>

                    </Grid>
                </Border>
            </Grid>
            <!--************************************-->
            <!--#endregion SPselectiondialog-->

            <!--#region SP Execute dialog-->
            <Grid x:Name="Execsp"
                Height="384" 
                Width="563"
                Canvas.Top="38" 
                Canvas.Left="85"    
                Panel.ZIndex="256"  
                MouseLeftButtonDown="ExecDragDialog_LButtonDn"
                MouseMove="ExecDragDialog_Moving"
                MouseLeftButtonUp="ExecDragDialog_Ending"
                PreviewKeyDown="Execsp_KeyDown"
                Focusable="True"                  
                HorizontalAlignment="Left"
                VerticalAlignment="Center" 
                Visibility="Collapsed" >

                <TextBlock x:Name="SpName" Visibility="Collapsed"/>

                <Border x:Name="innerborder"
                        BorderThickness="5" 
                        BorderBrush="Black"
                        KeyDown="Execsp_KeyDown"
                        PreviewMouseRightButtonDown="closeSearchDlg"
                        PreviewMouseLeftButtonDown="ExecDragDialog_LButtonDn"
                        PreviewMouseMove="ExecDragDialog_Moving"
                        PreviewMouseLeftButtonUp="ExecDragDialog_Ending"
                        HorizontalAlignment="Center"
                        VerticalAlignment="Center" Height="373" Width="630">

                    <Grid x:Name="innergrid"
                            Grid.Row="1" 
                            Height="{Binding ActualHeight, ElementName=innerborder}" 
                            Width="{Binding ActualWidth, ElementName=innerborder}"
                            Background="{StaticResource Cyan3}"
                           KeyDown="Execsp_KeyDown"
                            PreviewMouseRightButtonDown="closeSearchDlg"
                            HorizontalAlignment="Center" 
                            PreviewMouseLeftButtonDown="ExecDragDialog_LButtonDn"
                            PreviewMouseMove="ExecDragDialog_Moving"
                            PreviewMouseLeftButtonUp="ExecDragDialog_Ending"
                            VerticalAlignment="Top"
                            Visibility="Visible" Margin="0,-1,0,0" >

                        <Grid.RowDefinitions>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <StackPanel Orientation="Vertical" Background="Transparent" 
                                    HorizontalAlignment="Stretch" VerticalAlignment="Stretch">

                            <TextBlock x:Name="Headtext"
                                       Height="33"
                                       Text="Active S.P is : "
                                       TextAlignment="Center"
                                       FontSize="18"
                                       Padding="0 0 0 0"
                                       Background="Red" 
                                       Foreground="White" Margin="0,0,0,0"/>

                            <TextBlock x:Name="textprompt1"
                                Text="{Binding SPExecPrompt}"
                                TextAlignment="Center"
                                Padding="0 2 0 0"
                                Margin="33,5,22,0"     
                                Foreground="Black"
                                FontSize="16"
                                KeyDown="Execsp_KeyDown"
                                TextWrapping="Wrap"
                                UseLayoutRounding="True" 
                                PreviewMouseLeftButtonDown="ExecDragDialog_LButtonDn"
                                PreviewMouseMove="ExecDragDialog_Moving"
                                PreviewMouseLeftButtonUp="ExecDragDialog_Ending"
                                Height="54" 
                                RenderTransformOrigin="0.5,0.5"/>
                        </StackPanel>
                        <!--#region SP Execution  dialog-->

                    </Grid>
                </Border>

                <ListBox x:Name="SPText" 
                           Background="{StaticResource Gray3}" 
                           Foreground="Black" 
                           FontSize="16"
                           FontWeight="DemiBold"
                           Margin="16,104,15,152"/>

                <TextBox x:Name="selectSp"
                            Margin="12,240,13,82"
                            Text="Enter Arguments here ..."
                            TextAlignment="Center"
                            Focusable="True"
                            Padding="0 4 0 0"
                            FontWeight="Bold"
                            AcceptsReturn="False" 
                           KeyDown="Execsp_KeyDown"
                            MouseEnter="selectSp_MouseEnter"
                            MouseLeave="selectSp_MouseLeave"
                            PreviewMouseLeftButtonDown="selectSp_MouseLeftButtonDown"
                            AcceptsTab="false" 
                            ClipToBounds="True" 
                            UseLayoutRounding="True"
                            FontSize="18" />

                <Button x:Name="ExecBtn" 
                        Width="100" 
                        Height="41" 
                        HorizontalAlignment="Right" 
                        Margin="0,319,16,0"
                        VerticalAlignment="Top"
                        KeyDown="Execsp_KeyDown"
                        Content="Execute"
                        Command="{Binding FilterStoredprocs}"
                        Style="{StaticResource ButtonSlant}"                                
                        Visibility="Visible"
                        Click="Execsp_Click"/>

                <Button x:Name="stopBtn3" 
                        Width="100" 
                        Height="43" 
                        HorizontalAlignment="Right" 
                        Margin="0,319,124,0"
                        VerticalAlignment="Top"
                        Content="Cancel"
                        KeyDown="Execsp_KeyDown"
                        Style="{StaticResource DefaultCancelButton}"
                        Click="stopBtn1_Click"
                        Command="{Binding CloseFilterStoredprocs}"
                        Visibility="Visible"/>

            </Grid>
            <!--#endregion SP Execute dialog-->


            <!--#endregion popup controls-->

            <!--#region SPTableviewer-->

            <!--// This is the larger dialog that allow selection from any SP's that 
            //have returned after the SQL search has been completd-->
            <Grid x:Name="SpTableViewer" 
                    Height="490" 
                    Width="313"
                    Canvas.Top="38" 
                    Canvas.Left="325"
                    Background="{StaticResource Black2}"
                    Focusable="True"
                    Panel.ZIndex="256"  
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Top"
                   MouseLeftButtonDown="tableviewer_LButtonDn"
                    MouseMove="tableviewer_Moving"
                    MouseLeftButtonUp="tableviewer_Ending"
                    PreviewKeyDown="tableviewer_KeyDown"
                    Visibility="Collapsed" >

                <Border x:Name="innerresultsborder"
                        BorderThickness="5" 
                        BorderBrush="Red"
                        Visibility="Visible">

                    <Grid x:Name="InnerGrid"
                            Height="{Binding ActualHeight, ElementName=innerresultsborder,
                                Converter={StaticResource ReduceByParamValue},ConverterParameter=0}"
                          Width="{Binding ActualWidth, ElementName=innerresultsborder,
                                Converter={StaticResource ReduceByParamValue},ConverterParameter=0}"
                            HorizontalAlignment="Center" 
                            Background="{StaticResource Black2}"
                            VerticalAlignment="Center"
                            Visibility="Visible">

                        <Grid.RowDefinitions>
                            <RowDefinition x:Name="row10" Height="35"/>
                            <RowDefinition x:Name="row12" Height="*"/>
                            <RowDefinition  x:Name="row13" Height="50"/>
                        </Grid.RowDefinitions>

                        <TextBlock x:Name="Bannerline" 
                                Grid.Row="0"
                                Width="{Binding ActualWidth, ElementName=InnerGrid,
                                    Converter={StaticResource ReduceByParamValue},ConverterParameter=10}"
                                Height="35"
                                Text="All Tables in current Database"
                                TextAlignment="Center"
                                Padding="0 4 0 0"
                                Margin="0,0,0,0"
                                Background="Red"
                                Foreground="White" 
                                UseLayoutRounding="True" />

                        <ListBox x:Name="AllTables"
                                Grid.Row="1"
                                    Height="{Binding row10}"
                                    Width="{Binding InnerGrid,
                                Converter={StaticResource ReduceByParamValue},ConverterParameter=0}"
                                    Background="{StaticResource Black5}"
                                    Foreground="White"                                     
                                    SelectionMode="Single"
                                    FontSize="14"
                                    FontWeight="DemiBold"
                                    Margin="11,5,11,5"
                                    IsHitTestVisible="True"
                                    ScrollViewer.VerticalScrollBarVisibility="Auto"
                                    ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                    ItemContainerStyle="{StaticResource SpStringsStyle}"
                                    MouseLeftButtonDown="tableviewer_LButtonDn"
                                    MouseMove="tableviewer_Moving"
                                    MouseLeftButtonUp="tableviewer_Ending"
                                    PreviewKeyDown="tableviewer_KeyDown"
                                   Visibility="Visible" />

                        <Button x:Name="closebtn"                                 
                                    Grid.Row="2"
                                    Width="151" Height="35" 
                                    HorizontalAlignment="Right"                                     
                                    Margin="0,0,10, 9"
                                    VerticalAlignment="Bottom"
                                    FontSize="14"
                                    Style="{StaticResource ButtonSlant}"
                                    Content="Close Tables Viewer"
                                    Click="closeviewer_Click"
                                    Visibility="Visible"
                                    Foreground="Orange" />
                    </Grid>
                </Border>
            </Grid>
            <!--************************************-->
            <!--#endregion SPselectiondialog

            #region TreeViews

            // Controlling Border for all TreeView stuff-->

            <!--<Border x:Name ="TreeviewBorder" 
				  Background="{StaticResource Red5}"
				  Width="357" 
				  Height="400" 
				  BorderThickness="1"
				  BorderBrush="{StaticResource Black0}"
				  Canvas.Top="53"
				  Canvas.Left="280"
				  LostFocus="TreeviewBorder_LostFocus"
				  MouseMove="TreeviewBorder_MouseMove"
				  PreviewMouseLeftButtonUp="TreeviewBorder_PreviewMouseLeftButtonUp"
				  Visibility="Collapsed">

                <Grid>
                    -->
            <!--// *** THESE WORK !!! *** //-->
            <!--
                    <Grid.RowDefinitions>
                        <RowDefinition Height="35" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    -->
            <!--#region Db Tables Tree view-->
            <!--
                    <WrapPanel x:Name="TablesWrappanel"
						Grid.Row="0"  
						Orientation="Horizontal"
						Visibility="Visible">

                        <Label  x:Name="TablesLabel"
								Background="{StaticResource Red3}"
								Content="All Db Tables"
								FontWeight="DemiBold"
								Foreground="{StaticResource White0}"
								HorizontalAlignment="Left"
								HorizontalContentAlignment="Center"
								Height="30"
								Margin="0 5 0 0 "
								  PreviewMouseLeftButtonDown="TreeviewBorder_PreviewMouseLeftButtonDown"
								  PreviewMouseLeftButtonUp="TreeviewBorder_PreviewMouseLeftButtonUp"
								Visibility="Visible"
								Width="315"/>

                        <Image  Source="/icons/Whitecross.png" 
							  Height="20"
							  Margin="0 2 0 0"
							  PreviewMouseLeftButtonDown="Image_PreviewMouseLeftButtonDown"
							  HorizontalAlignment="Right"
							  Visibility="Visible"/>
                    </WrapPanel>

                    <TreeView x:Name="DbTablesTree"  
							Grid.Row="1"
							HorizontalAlignment="Left" 
							Width="{Binding Path=Width, ElementName=TreeviewBorder}" 
							Background="{StaticResource Cyan2}"
							SelectedItemChanged="DbTablesTree_SelectedItemChanged"
						    ScrollViewer.HorizontalScrollBarVisibility="Disabled"
							Visibility="Hidden">
                        <TreeView.ItemTemplate>
                            <HierarchicalDataTemplate DataType="{x:Type Viewmodels:Database}" ItemsSource="{Binding Path=Tables}" >
                                <TextBlock 
									     Text="{Binding Databasename}" 
									     VerticalAlignment="Center" 
									     Margin="5"
										FontSize="14"
										FontWeight="DemiBold"
									     Foreground="{StaticResource Black0}"
										Height="20"
										PreviewMouseLeftButtonUp="TextBlock_PreviewMouseLeftButtonUp"									
										Width="{Binding Path=Width, ElementName=DbTablesTree}"></TextBlock>

                                <HierarchicalDataTemplate.ItemTemplate>
                                    <DataTemplate DataType="{x:Type Viewmodels:SqlTable}">
                                        <TextBlock 
											FontSize="14"
											Foreground="{StaticResource Black3}"
											Height="20"												
											Margin="5"
											PreviewMouseRightButtonUp="TablesLabel_PreviewMouseRightButtonUp"
											Text="{Binding Tablename}" 
											VerticalAlignment="Center" 
											Width="{Binding Path=Width, ElementName=DbTablesTree}"></TextBlock>
                                    </DataTemplate>
                                </HierarchicalDataTemplate.ItemTemplate>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>

                    </TreeView>-->

            <!--#endregion Db Tables Tree view-->

            <!--#region sp tree view-->

            <!--<WrapPanel  x:Name="SpWrappanel"
						Grid.Row="0"  Orientation="Horizontal"
						     Visibility="Visible"
                               >

                        <Label  x:Name="SpLabel"
								Background="{StaticResource Red3}"
								Content="Stored Procedures"
								Foreground="{StaticResource White0}"
								HorizontalContentAlignment="Center"
								  PreviewMouseLeftButtonDown="TreeviewBorder_PreviewMouseLeftButtonDown"
								  PreviewMouseLeftButtonUp="TreeviewBorder_PreviewMouseLeftButtonUp"
								Height="30"
								Margin="0 5 0 0 "
								Visibility="Visible"
								Width="316"/>

                        <Image  Source="/Icons/Whitecross.png" 
							  Height="20"
							  PreviewMouseLeftButtonDown="Image_PreviewMouseLeftButtonDown"
							  HorizontalAlignment="Right"
							  Margin="0 2 0 0"
							  Visibility="Visible"/>
                    </WrapPanel>-->

            <!--<TreeView x:Name="DbProcsTree"  
							Background="{StaticResource Orange7}"
							Expander.Expanded="DbProcsTree_Expanded"
						    Expander.Collapsed="DbProcsTree_Collapsed"
							Grid.Row="1"
							HorizontalAlignment="Center" 
							PreviewMouseRightButtonUp="DbProcsTree_PreviewMouseRightButtonUp"
							ScrollViewer.HorizontalScrollBarVisibility="Disabled"
							SelectedItemChanged="DbProcsTree_SelectedItemChanged"	 						    
							Visibility="Visible"
							Width="355">-->

            <!--<TreeView.Resources>
                        </TreeView.Resources>

                        <Style TargetType="{x:Type TreeViewItem}">
							<Setter Property="IsExpanded" Value="{Binding Path=IsNodeExpanded, ElementName=Listviews}"/>
						</Style>
                        <TreeView.ItemContainerStyle>
                            <Style TargetType="TreeViewItem">
                                <Setter Property="IsSelected" Value="{Binding IsSelected}" />
                                <Setter Property="IsExpanded" Value="{Binding IsExpanded}" />
                                <Setter Property="Height" Value="16" />
                            </Style>
                        </TreeView.ItemContainerStyle>

                        <TreeView.ItemTemplate >
                            <HierarchicalDataTemplate DataType="{x:Type Viewmodels:Database}" ItemsSource="{Binding Path=Procedures}" >
                                <Expander Header="{Binding Databasename}" IsExpanded="True">
                                <TextBlock 
									     Text="{Binding Databasename}" 
									     VerticalAlignment="Center" 
									     Margin="5"
										FontSize="12"
										FontWeight="DemiBold"
									     Foreground="{StaticResource Black0}"
										Height="15"
										Width="{Binding Path=Width, ElementName=DbTablesTree}"></TextBlock>
                                </Expander>
                                <HierarchicalDataTemplate.ItemTemplate>
                                    <DataTemplate DataType="{x:Type Viewmodels.SqlProcedures}">
                                        <TextBlock 
											FontSize="11"
											Foreground="{StaticResource Black3}"
											Height="14"
											Margin="5"
											PreviewMouseRightButtonUp="TextBlock_PreviewMouseRightButtonUp"
											Text="{Binding Procname}" 
											VerticalAlignment="Center" 
											Width="{Binding Path=Width, ElementName=DbProcsTree}">
                                        </TextBlock>
                                    </DataTemplate>
                                </HierarchicalDataTemplate.ItemTemplate>
                            </HierarchicalDataTemplate>
                        </TreeView.ItemTemplate>

                    </TreeView>-->

            <!--#endregion SP Tree view-->
        </Canvas>
    <!--</Grid>-->
            <!--</Border>-->

            <!--<Border x:Name ="SpTreeviewBorder" 
				  Background="{StaticResource Red5}"
				  Width="357" 
				  Height="400" 
				  BorderThickness="1"
				  BorderBrush="{StaticResource Black0}"
				  Canvas.Top="53"
				  Canvas.Left="280"
				  LostFocus="TreeviewBorder_LostFocus"
				  MouseMove="TreeviewBorder_MouseMove"
				  PreviewMouseLeftButtonUp="TreeviewBorder_PreviewMouseLeftButtonUp"
				  Visibility="Collapsed">

                <Grid>
                    --><!--// *** THESE WORK !!! *** //--><!--
                    <Grid.RowDefinitions>
                        <RowDefinition Height="35" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>


                    --><!--#region SP Tree view--><!--

                    <WrapPanel  x:Name="Sp2Wrappanel"
						Grid.Row="0"  Orientation="Horizontal"
						     Visibility="Visible">

                        <Label  x:Name="Sp2Label"
								Background="{StaticResource Red3}"
								Content="Stored Procedures"
								Foreground="{StaticResource White0}"
								HorizontalContentAlignment="Center"
								  PreviewMouseLeftButtonDown="TreeviewBorder_PreviewMouseLeftButtonDown"
								  PreviewMouseLeftButtonUp="TreeviewBorder_PreviewMouseLeftButtonUp"
								Height="30"
								Margin="0 5 0 0 "
								Visibility="Visible"
								Width="316"/>

                        <Image  Source="/icons/Whitecross.png" 
							  Height="20"
							  PreviewMouseLeftButtonDown="Image_PreviewMouseLeftButtonDown"
							  HorizontalAlignment="Right"
							  Margin="0 2 0 0"
							  Visibility="Visible"/>
                    </WrapPanel>


                </Grid>
            </Border>-->
            <!--#endregion TreeViews-->

            <user:FlowDoc x:Name="Flowdoc"
				backGround="{StaticResource Gray5}"
				borderColor="{StaticResource Orange1}"
				Canvas.Left="45"
				Canvas.Top="64"
				Height="300"
                Width="520"
				Margin="0 0 0 0"
				
				LostFocus="Flowdoc_LostFocus"
				MouseLeftButtonUp="Flowdoc_MouseLeftButtonUp"	
				MouseMove="Flowdoc_MouseMove"
				PreviewMouseLeftButtonDown="Flowdoc_PreviewMouseLeftButtonDown"

				Opacity="1"
				Panel.ZIndex="260"
				Visibility="Visible"/>


        <!--</Canvas>-->

        <!--//*** Container for Grid  + GridSpltter +  SpList  + FlowDocument ***//

        // Containerwith 3 rows for both major view panels & its horizontal splitter-->
        <Grid x:Name="majorgrid" Grid.Row="1" Grid.RowSpan="1">

            <!--Hieararchy is : 
                majorgrid   (3  rows)
                        InfoGrid   in row 2
                            InfoBorder 
                                ViewerGrid
                                    GridSplitter
                                        banner + spList + RTBox-->

            <Grid.RowDefinitions>
                <RowDefinition x:Name="dgrow" Height="*"/>
                <RowDefinition x:Name="sprow" Height="30"/>
                <RowDefinition x:Name="vwrow" Height="*"/>
            </Grid.RowDefinitions>

            <!--//DataGrid -  lives in top row of majorgrid-->
            <users:DatagridControl x:Name="GenGridCtrl"   
                Grid.Row="0" 
                Grid.RowSpan="1"
                Background="Transparent" 
                Foreground="Black"
                FontSize="16"
                FontWeight="Normal"
                AlternateBackground="Cyan"
                HeaderBackground="Blue"
                HeaderForeground="White"                               
                Margin="5,0,5,0"
                PreviewMouseRightButtonDown="GenGridCtrl_PreviewMouseRightButtonDown"
                Visibility="Visible"
                Tablename="BankAccount" VerticalAlignment="Top" >
            </users:DatagridControl>

            <GridSplitter x:Name="Hsplitter" 
                        Grid.Row="1" 
                        Width="{Binding ActualWidth, ElementName=splitterText}"
                        Height="30"
                        Grid.Column="0"
                        Grid.ColumnSpan="3"
                        HorizontalAlignment="Stretch"
                        Focusable="True"
                        Cursor="SizeNS"
                        MouseEnter="hGridSplitter_MouseEnter" 
                        MouseLeave="hGridSplitter_MouseLeave"
                        MouseMove="Hsplitter_MouseMove"
                        Background ="{StaticResource HorizontalGraduated}"
                        ResizeBehavior="PreviousAndNext"
                        ToolTipService.ToolTip="Drag up / down to Show / Hide DataGrid"
                        ToolTipService.HasDropShadow="True"
                        ToolTipService.BetweenShowDelay="5"
                        ToolTipService.ShowDuration="5000"
                        Panel.ZIndex="265"
                        VerticalAlignment="Stretch">
                <GridSplitter.Template>
                    <ControlTemplate>
                        <Grid 
						   Background ="{StaticResource HorizontalGraduated}">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="20" />
                            </Grid.RowDefinitions>
                            <StackPanel 
                                Orientation="Horizontal" 
                                HorizontalAlignment="Center" 
                               Background ="Transparent"
                                Grid.Row="0"  
                                >
                                <TextBlock Text="Drag Up/Down here to change panel sizes" 
                                        Height="20" 
                                        Padding="0 4 4 0" 
                                        FontSize="12"
                                           
                                        Foreground="Black"
                                        FontWeight="DemiBold"
                                        Background ="Transparent"
                                        HorizontalAlignment="Left" Margin="30,0,0,0"/>
                                <Image x:Name="ImgUp"  Source="\icons\updown arrow red copy.png"  Margin="30 4 0 0"
										               Height="25" Width="20" HorizontalAlignment="Right"/>
                            </StackPanel>
                        </Grid>

                    </ControlTemplate>
                </GridSplitter.Template>

            </GridSplitter>

            <!--Entire  lower panel for info etc
            #region grid InfoGrid
            //Information panel viewer -  lives in bottom row of majorgrid-->
            
            <Grid x:Name="InfoGrid"
                    Grid.Row="2" 
                    Margin="0 -5 0 15" 
                    Canvas.Top="5"
                    Canvas.Left="10"
                    Background="Transparent"  
                    Width="{Binding ActualWidth, ElementName=GenGridCtrl, Converter={StaticResource ReduceByParamValue},ConverterParameter=0}"      
                    IsVisibleChanged="InfoGrid_IsVisibleChanged"
                    Visibility="Visible" >

                <!--#region inner info viewer and SP list box container & V Splitter-->
                <Border x:Name="InfoBorder" 
                            BorderBrush="{StaticResource HeaderBrushHorizontalBlackToBlueToBlack}" 
                            Background="{StaticResource Orange2BlackSlant}"                    
                            Margin="0 5 0 0"
                            Opacity="1"
                            BorderThickness="5 5 5 15" 
                            VerticalAlignment="Top" 
                           Height="{Binding ActualHeight, ElementName=InfoGrid}" 
                            Width="{Binding ActualWidth, ElementName=InfoGrid}"
                            Visibility="Visible">

                    <!--// Required  to Handle layout of lower panel with V.Splitter, SP lstbox and info viewer-->
                    <Grid x:Name="ViewerGrid"                          
                                Grid.Row="0"
                                Grid.RowSpan="1"
                                VerticalAlignment="Top"
                                HorizontalAlignment="Left"
                               Height="{Binding ActualHeight, ElementName=InfoBorder, Converter={StaticResource IncreaseByParamValue},ConverterParameter=5}"      
                                Width="{Binding ActualWidth, ElementName=InfoGrid}"
                                Visibility="Visible">

                        <Grid.RowDefinitions>
                            <RowDefinition Height="25"/>
                            <RowDefinition Height="1"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Grid.ColumnDefinitions>
                            <ColumnDefinition x:Name="col1" MaxWidth="300" Width="*" />
                            <ColumnDefinition x:Name="col2" Width="15"/>
                            <ColumnDefinition x:Name="col3" Width="*"/>
                        </Grid.ColumnDefinitions>

                        <GridSplitter x:Name="Vsplitter" 
                                           Grid.Row="2" 
                                           Grid.RowSpan="1" 
                                           Width="15"
                                             Grid.Column="1"
                                           Focusable="True"
                                           Cursor="SizeWE"
                                           MouseEnter="GridSplitter_MouseEnter" 
                                           MouseLeave="GridSplitter_MouseLeave"
                                           MouseMove="Vsplitter_MouseMove"
                                           Background ="{StaticResource VerticalGraduated}"
                                            ResizeBehavior="PreviousAndNext"
                                           ToolTipService.ToolTip="Drag to Show / Hide List of Stored Procedures"
                                           ToolTipService.HasDropShadow="True"
                                           ToolTipService.BetweenShowDelay="5000"
                                           ToolTipService.ShowDuration="3000"
                                            VerticalAlignment="Stretch">

                        </GridSplitter>

                        <!--// Red Banner on top of plist-->

                        <!--#region Banner-->

                        <Grid x:Name="bannergrid" Grid.Row="0" Grid.RowSpan="1" Grid.Column="0" Grid.ColumnSpan="3">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="30"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock x:Name="InfoHeaderPanel" Grid.Column="0" Grid.ColumnSpan="1"
                                    Margin="0 0 0 0"                                            
                                    HorizontalAlignment="Stretch"
                                    VerticalAlignment="Top" 
                                    Height="35"
                                        FontSize="16"
                                    FontWeight="DemiBold"
                                    Foreground="Red"
                                    Background="Cyan"
                                    TextAlignment="Center"
                                    Text="Press Escape, Dbl-Click in viewer or Click 'Close' icon on this panel to close it...."/>

                            <Border Background="Cyan" Grid.Column="1" Grid.ColumnSpan="1">
                                <Image
                                                                x:Name="CloseIcon" Source="\icons\red-cross-icon.png"
                                                                Grid.Column="1"                           
                                                                Height="25" Width="25"
                                                              HorizontalAlignment="Right"
                                                                MouseLeftButtonDown="CloseIcon_MouseLeftButtonDown"
                                                                Margin="0,-1,6,0" Grid.RowSpan="1"/>
                            </Border>
                        </Grid>
                        <!--#endregion Banner-->

                        <!--#region SP List box-->
                        <Grid x:Name="tempgrid" Grid.Row="2" 
                                        Grid.RowSpan="1" 
                                        Grid.Column="0"  
                                        Height="{Binding Height, ElementName=InfoBorder, Converter={StaticResource ReduceByParamValue},ConverterParameter=20}"      
                                        HorizontalAlignment="Stretch" 
                                        MaxWidth="300"                                  
                                        VerticalAlignment="Stretch"
                                        Visibility="Visible">

                            <Grid.RowDefinitions>
                                <RowDefinition x:Name="currow1" Height="25"/>
                                <RowDefinition x:Name="currow3" Height="25"/>
                                <RowDefinition x:Name="currow2" Height="*"/>
                            </Grid.RowDefinitions>

                            <TextBlock x:Name="SpInfo" 
                                                Grid.Row="0"
                                                Text="Info"
                                                FontSize="16"
                                                Margin="0 -2 0 0"
                                                Height="25"
                                                Background="{StaticResource Red3}" 
                                                Foreground="White"
                                                TextAlignment="Center"
                                                HorizontalAlignment="Stretch"/>

                            <TextBlock x:Name="SpInfo2" 
                                                Grid.Row="1"
                                                Text="Sp entry...."
                                                FontSize="16"
                                                Margin="0 -11 0 0"
                                                Height="25"
                                                Background="{StaticResource White3}" 
                                                Foreground="{StaticResource Red3}"
                                                TextAlignment="Center"
                                                HorizontalAlignment="Stretch"/>

                            <ListBox x:Name="Splist" 
                                                Grid.Row="3"
                                                Grid.RowSpan="1" 
                                                Margin="0 -3 0 0"
                                                Height="{Binding Height, ElementName=tempgrid, 
                                                Converter={StaticResource ReduceByParamValue},ConverterParameter=60}"    
                                                Width="{Binding Width, ElementName=ViewerGrid.col1}"    
                                                VerticalAlignment="Top"
                                                MaxWidth="300"
                                                FontSize="16"
                                                SelectionChanged="Splist_SelectionChanged"
                                                PreviewMouseRightButtonDown="Splist_PreviewMouseRightButtonDown"
                                                PreviewMouseRightButtonUp="Splist_PreviewMouseRightButtonUp"
                                                PreviewMouseDoubleClick="Splist_PreviewMouseDoubleClick"
                                                FontWeight="DemiBold"     
                                                ToolTipService.InitialShowDelay="1000"
                                                ToolTipService.ShowDuration="1500"
                                                Foreground="Black"                                                
                                                ItemContainerStyle="{StaticResource SpStringsStyle}">
                                <ListBox.ToolTip  >
                                    <ToolTip>
                                        <Border Width="240" Height="105" BorderBrush="{StaticResource Red4}" BorderThickness="2">
                                            <TextBlock x:Name="ViewerBanner"
                                                        Text="Right click to toggle list between All SP's and only those that contain the current search text"
                                                        Padding="10 5 10 10"
                                                        Background="{StaticResource White3}"
                                                        Foreground="Black"
                                                        FontSize="16"
                                                        TextWrapping="Wrap"/>
                                        </Border>
                                    </ToolTip>
                                </ListBox.ToolTip>
                            </ListBox>
                        </Grid>
                        <!--#endregion SP List box-->

                        <!--#region FlowdocScrollViewer-->

                        <FlowDocumentScrollViewer x:Name="RTBox" 
                                            Grid.Row="2" 
                                            Grid.RowSpan="1"
                                            Grid.Column="2"                               
                                            MinWidth="200"    
                                            BorderBrush="White"
                                            BorderThickness="2"
                                            Height="{Binding Height, ElementName=ViewerGrid, Converter={StaticResource ReduceByParamValue},ConverterParameter=85}"      
                                            Width="{Binding Width, ElementName=ViewerGrid, Converter={StaticResource ReduceByParamValue},ConverterParameter=40}"      
                                             Margin="0 0,0,5"
                                            HorizontalScrollBarVisibility="Auto"
                                            VerticalScrollBarVisibility="Visible"
                                            Background="{StaticResource Black0}"
                                            Foreground="{StaticResource White0}"                                              
                                            PreviewKeyDown="RTBox_PreviewKeyDown"
                                            ScrollBar.Scroll="RTBox_Scroll"
                                            PreviewMouseRightButtonDown="RTBox_PreviewMouseRightButtonDown"
                                            TextOptions.TextFormattingMode="Ideal"
                                            TextOptions.TextRenderingMode="ClearType"
                                            ToolTip="Right Click for further Options"
                                            ToolTipService.ShowDuration="2000"
                                            ToolTipService.BetweenShowDelay="5000"
                                            Visibility="Visible">
                        </FlowDocumentScrollViewer>

                        <!--#endregion FlowdocScrollViewer-->


                    </Grid>
                    <!--// ViewerGrid-->
                </Border>
                <!--// InfoBorder-->

                <!--#endregion inner info viewer and SP list box container-->

            </Grid>
            <!--// InfoGrid-->
            <!--// #endregion grid InfoGrid-->


        </Grid>
        <!--#endregion Canvas-->

        <!--//*****************//
        SQL Tables Datagrid
        //*****************//-->

        <!--// bottom buttons/controls panel//-->
        <!--#region Main Btn Panel-->
        <!--//*********************//-->
        <Grid x:Name="BtnGrid" Grid.Row="4" Grid.RowSpan="3"
            PreviewMouseRightButtonDown="RTBox_PreviewMouseRightButtonDown">
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/>
                <RowDefinition Height="80"/>
                <RowDefinition Height="90"/>
            </Grid.RowDefinitions>
            <ComboBox x:Name="SqlTables" 
                  Grid.Row="1" HorizontalAlignment="Left" 
                  Width="200" Height="25"  FontSize="16"
                  Margin="132,9,0,0" 
                   VerticalAlignment="Top"
                  HorizontalContentAlignment="Center"
                  SelectionChanged="SqlTables_SelectionChanged"/>

            <Label Content="Select SQL Table : " 
                 Grid.Row="1"
               HorizontalAlignment="Left"               
               Foreground="White"  
               Width="116"
               FontSize="14"
                 Margin="15,7,0,47" />

            <CheckBox x:Name="ToggleColumnHeaders" Checked="ToggleColumnHeaders_Checked" 
                  IsChecked="false" 
                  Content="Toggle headers" 
                  HorizontalAlignment="Left"
                  Foreground="White" 
                  FontSize="16" 
                  VerticalAlignment="Top"
                  Click="ToggleColumnHeaders_Click" 
                  Height="20" 
                  Margin="267,35,0,0" 
                  Grid.Row="3"
                  Width="132" 
                  RenderTransformOrigin="0.5,0.5"
                   Visibility="Collapsed"/>

            <Button x:Name="CloseApp" Width="87" 
                Grid.Row="1"
                Height="NaN" 
                Content="Close App" 
                HorizontalAlignment="Right"
                BorderBrush="Red"                
                Click="CloseApp_Click" Margin="0,46,80,5" 
                Style="{StaticResource ButtonSlant}"/>

            <Button x:Name="CloseBtn" Width="67" 
                Grid.Row="1"
                Height="NaN" 
                Content="Close" 
                HorizontalAlignment="Right"
                BorderBrush="Red"                
                Click="Close_Click" Margin="0,46,5,5" 
                Style="{StaticResource ButtonSlant}"/>

            <TextBlock
                Grid.Row="1" 
                Foreground="White"
                Background="Transparent"
                FontSize="15"
                 Text="Use Dropdown below to select available processing options"
                HorizontalAlignment="Left" 
                Width="403" Height="26"  
                Margin="360,14,0,0" 
                VerticalAlignment="Top" />

            <ComboBox x:Name="OptionsList" 
                    Grid.Row="1" 
                    HorizontalAlignment="Left" 
                    Width="270"
                    Height="30"  
                    FontSize="18"
                    Margin="403,0,0,14" 
                     DropDownOpened="OptionsList_DropDownOpened"
                      DropDownClosed="OptionsList_DropDownClosed"
                    SelectionChanged="OptionsList_Selected"
                    VerticalAlignment="Bottom"
                    HorizontalContentAlignment="Center"   >

                <ComboBoxItem >
                    <TextBlock Text="Processing Options" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText1" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
                <ComboBoxItem  >
                    <TextBlock Text="Show Full Schema" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText2" TextAlignment="Center" Width="245" />
                </ComboBoxItem >
                <ComboBoxItem >
                    <TextBlock Text="Reload Tables List" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText3" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="---------------------------------" Style="{StaticResource SplitterComboStyle}"
                        x:Name="comboText4" TextAlignment="Center" Width="245" FontSize="10" IsEnabled="False"/>
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="Save as New Table" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText5" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="Filter table data" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText6" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="Save Selected Rows to Table" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText7" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="---------------------------------" Style="{StaticResource SplitterComboStyle}"
                        x:Name="comboText8" TextAlignment="Center" Width="245" FontSize="10" IsEnabled="False"/>
                </ComboBoxItem>
                <ComboBoxItem >
                    <TextBlock Text="Find Text in Stored Procedures" Style="{StaticResource YellowTextGradient}"
                        x:Name="comboText9" TextAlignment="Center" Width="245" />
                </ComboBoxItem>
            </ComboBox>

            <TextBlock x:Name="Reccount" 
                Grid.Row="1"
                   FontSize="18"
                   FontWeight="Bold"
                   TextAlignment="Center"
                   Padding="0 2 0 0"
                Height="30" Width="68" 
                HorizontalAlignment="Right"
                VerticalAlignment="Bottom"
                   Margin="0 0 5 47"
                    Background="Orange"
                   Foreground="Black"/>

            <Label Content="Save New Table As : " 
                    Grid.Row="1" 
                    HorizontalAlignment="Left"
                    Foreground="White"  
                    Width="130"
                     FontSize="14"
                    Margin="1,46,0,8"/>

            <TextBox x:Name="NewTableName" 
                 Width="200" 
                 Foreground="Red"  
                 Grid.Row="1" 
                 FontSize="16"
                HorizontalAlignment="Left"  
                 HorizontalContentAlignment="Center" 
                 Text="Enter New Table Name ...." 
                 Padding="0 1 0 0"
                KeyDown="statusbar_KeyDown"
                Margin="132,45,0,10" 
                 GotKeyboardFocus="NewTableName_GotKeyboardFocus"
                 />

            <TextBlock x:Name="caption"
                    Text="Current Table Status / Processing information" 
                    Grid.Row="0" 
                    HorizontalAlignment="Stretch"
                    TextAlignment="Center"
                    TextWrapping="Wrap"
                    Background="{StaticResource Red2}"
                    Padding="0 4 0 0"
                    Foreground="{StaticResource White1}"  
                    FontSize="15"
                    FontWeight="DemiBold"
                    FontStyle="Normal"/>

            <TextBlock x:Name="statusbar"
                    Text="" Grid.Row="2" 
                    HorizontalAlignment="Stretch"
                    TextAlignment="Center"
                    TextWrapping="Wrap"
                    Background="{StaticResource White7}"
                    Padding="10 2 0 10"
                    Foreground="White"  
                    FontSize="15"
                    FontStyle="Italic"/>
            <!--//************************//-->

        </Grid>
        <!--#endregion Main Btn Panel-->

        <!--// TREEVIEW EXAMPLE FOR TESTING-->
        <!--<TreeView ItemsSource="{Binding Source={StaticResource MyBooks}, Path=Booklist}">
            <TreeView.Resources>
                -->
        <!--// Format for Hierarchcal treeview data
                // x:Types are all classes-->
        <!--
                <HierarchicalDataTemplate DataType="{x:Type local:Book}"
                                          ItemsSource="{Binding Chapters}">
                    <TextBlock Text="{Binding BookTitle"/>
                </HierarchicalDataTemplate>
                <HierarchicalDataTemplate DataType="{x:Type local:Chapter}"
                                          ItemsSource="{Binding Articles}">
                    <TextBlock Text="{Binding ChapterTitle"/>
                </HierarchicalDataTemplate>
                <DataTemplate DataType="{x:Type local: Chapter?}">
                    <WrapPanel>
                        <TextBlock Text="{Binding ChapterTtile}"/>
                        <Line X1="1" X2="100" Stretch="Fill" StrokeThickness="1" Stroke="Red" StrokeDashArray="1"/>
                        <TextBlock Text="{Binding PageNum}"/>
        </WrapPanel>
                  </DataTemplate>
            </TreeView.Resources>
        </TreeView>-->

    </Grid>
</Window>
    
